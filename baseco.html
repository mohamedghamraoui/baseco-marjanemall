<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Base de Connaissances Marjanemall - Intelcia</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+Arabic:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --teal-deep: #006E6A;
            --teal-light: #00B8A9;
            --neutral-bg: #F5F5F5;
            --neutral-border: #E0E0E0;
            --background: #ffffff;
            --foreground: #1f2937;
            --border: #e5e7eb;
            --orange: #FF6B35;
            --orange-light: #FF8A65;
        }
        
        * { 
            box-sizing: border-box; 
            margin: 0; 
            padding: 0; 
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            color: var(--foreground);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Banni√®re roulante */
        .rolling-banner {
            background: linear-gradient(45deg, var(--teal-deep), var(--teal-light), var(--orange), var(--orange-light));
            background-size: 400% 400%;
            animation: gradientShift 6s ease infinite;
            color: white;
            padding: 12px 0;
            overflow: hidden;
            position: relative;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .banner-content {
            display: flex;
            animation: scroll 20s linear infinite;
            white-space: nowrap;
            font-weight: 600;
            font-size: 18px;
            letter-spacing: 1px;
        }
        
        @keyframes scroll {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        
        .banner-text {
            padding: 0 50px;
            display: inline-flex;
            align-items: center;
            gap: 20px;
        }
        
        /* Layout principal */
        .main-container {
            display: flex;
            min-height: calc(100vh - 48px);
        }
        
        /* Sidebar */
        .sidebar {
            width: 35%;
            background: white;
            border-right: 2px solid var(--border);
            overflow-y: auto;
            max-height: calc(100vh - 48px);
            box-shadow: 2px 0 8px rgba(0,0,0,0.1);
        }
        
        .sidebar-header {
            background: var(--teal-deep);
            color: white;
            padding: 1.5rem;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .sidebar-header h2 {
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .search-container {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 70px;
            background: white;
            z-index: 9;
        }
        
        .search-input {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid var(--border);
            border-radius: 20px;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            border-color: var(--teal-light);
            box-shadow: 0 0 0 3px rgba(0, 184, 169, 0.1);
            outline: none;
        }
        
        .tree-container {
            padding: 1rem;
        }
        
        .tree-category {
            margin-bottom: 1rem;
        }
        
        .category-header {
            background: var(--teal-light);
            color: white;
            padding: 0.8rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
        }
        
        .category-header:hover {
            background: var(--teal-deep);
        }
        
        .category-arrow {
            transition: transform 0.3s ease;
        }
        
        .category-header.expanded .category-arrow {
            transform: rotate(90deg);
        }
        
        .subcategories {
            display: none;
            margin-top: 0.5rem;
            margin-left: 1rem;
        }
        
        .subcategories.expanded {
            display: block;
        }
        
        .subcategory {
            margin-bottom: 0.5rem;
        }
        
        .subcategory-header {
            background: #f8fafc;
            border: 1px solid var(--border);
            padding: 0.6rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
        }
        
        .subcategory-header:hover {
            background: var(--orange-light);
            color: white;
        }
        
        .processes {
            display: none;
            margin-top: 0.5rem;
            margin-left: 1rem;
        }
        
        .processes.expanded {
            display: block;
        }
        
        .process-item {
            background: white;
            border: 1px solid var(--border);
            padding: 0.5rem;
            margin-bottom: 0.3rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            border-left: 3px solid var(--teal-light);
        }
        
        .process-item:hover {
            background: var(--teal-light);
            color: white;
            transform: translateX(5px);
        }
        
        .process-item.active {
            background: var(--orange);
            color: white;
            border-left-color: var(--orange);
        }
        
        /* Zone de contenu principale */
        .content-area {
            width: 65%;
            padding: 2rem;
            overflow-y: auto;
        }
        
        .content-header {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .content-header h1 {
            color: var(--teal-deep);
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .content-header p {
            color: var(--foreground);
            opacity: 0.8;
        }
        
        .process-details {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            min-height: 400px;
        }
        
        .process-title {
            color: var(--teal-deep);
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--teal-light);
            padding-bottom: 0.5rem;
        }
        
        .process-step {
            background: #f8fafc;
            border-left: 4px solid var(--teal-light);
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 0 8px 8px 0;
        }
        
        .step-title {
            font-weight: 600;
            color: var(--teal-deep);
            margin-bottom: 0.5rem;
        }
        
        .step-content {
            line-height: 1.6;
        }

        .process-overview {
            background: #f8fafc;
            border-left: 4px solid var(--teal-light);
            padding: 15px 20px;
            margin-bottom: 20px;
            font-style: italic;
            color: #4a5568;
            border-radius: 0 8px 8px 0;
        }

        .process-section {
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .section-title {
            background: var(--teal-deep);
            color: white;
            padding: 12px 20px;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .section-overview {
            background: #f0f9ff;
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
        }

        .section-process {
            padding: 15px 20px;
        }
        
        .welcome-message {
            text-align: center;
            color: var(--foreground);
            opacity: 0.7;
            font-size: 1.1rem;
            margin-top: 2rem;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                max-height: 50vh;
            }
            
            .content-area {
                width: 100%;
            }
            
            .banner-content {
                font-size: 16px;
            }
            
            .content-header h1 {
                font-size: 1.5rem;
            }
        }
        
        @media (max-width: 480px) {
            .sidebar {
                max-height: 40vh;
            }
            
            .content-header {
                padding: 1rem;
            }
            
            .process-details {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Banni√®re roulante -->
    <div class="rolling-banner">
        <div class="banner-content">
            <div class="banner-text">
                üåü MISE A JOUR PROCESSUS üåü Un remboursement Wafacash est dor√©navant valable 3 mois (90 jours). Merci de le prendre en consid√©ration lors des remont√©es niveau 2. üåü
            </div>
        </div>
    </div>

    <div class="main-container">
        <!-- Sidebar avec arborescence -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>üóÇÔ∏è Processus Marjanemall</h2>
            </div>
            
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Rechercher un processus..." id="searchInput" onkeyup="searchKnowledge()">
            </div>
            
            <div class="tree-container" id="treeContainer">
                <!-- L'arborescence sera g√©n√©r√©e ici par JavaScript -->
            </div>
        </div>

        <!-- Zone de contenu principale -->
        <div class="content-area">
            <div class="content-header">
                <h1>Base de Connaissances Marjanemall</h1>
                <p>Syst√®me Expert de Support Client - Powered by Intelcia</p>
            </div>
            
            <div class="process-details" id="processDetails">
                <div class="content-header">
                <h2>LES R√àGLES G√âN√âRALES DE TRAITEMENT</h2>
                <p>* Afin d‚Äôassurer le bon traitement des demandes client en respectant l‚Äôensemble des process CDO et une Gestion des Relations client fluide, l‚Äôagent - Conseiller client est tenu √† la base de respecter l‚Äôensemble des r√®gles dites les normes g√©n√©rales de traitement marjanemall. </p>                
                <p>* Il faut faire la diff√©rence entre le canal adopt√© par le client lors de la cr√©ation de sa demande : Un ticket RS, un mail ou un appel t√©l√©phonique. </p>                
                <p>* Apr√®s avoir assign√© le ticket √† lui en cliquant sur ‚ÄúMe l‚Äôaffecter‚Äù et lire attentivement le dossier client, l‚Äôagent est tenu d'identifier la demande client afin de mieux apporter la bonne r√©ponse. </p>                
                <p>* L‚Äôagent est tenu aussi de personnaliser le client via son nom afin de cr√©er une valeur ajout√©e lors de la communication. </p>                
                <p>* En termes d‚Äôhistorisation, l‚Äôagent est tenu d‚Äôhistoriser son traitement, permettant √† l'agent suivant d‚Äôenchainer le traitement direct de la demande client.</p>
            </div>
        </div>
    </div>

    <script>
        // Donn√©es de l'arborescence Marjanemall compl√®te
        const knowledgeBase = {
            "Annulation de la commande": {
                "Exp√©di√©e": {
                    "Refus de livraison": {
                        title: "Refus de livraison",
                        overview: "Cette fiche a pour objectif d'assister les agents du CRC dans le traitement des demandes clients relatives √† l'annulation de commandes, sous r√©serve que celles-ci n'aient pas encore √©t√© exp√©di√©es.\\n\\nElle pr√©sente l'ensemble des √©tapes √† suivre par l'agent CC, le script √† communiquer au client concern√©, ainsi que le traitement √† effectuer dans le ticket Zendesk.\\n\\nIl est √† noter qu‚Äô√† la base, il est impossible d‚Äôannuler une commande exp√©di√©e. Pour cela, le CRC propose au client de bien refuser la livraison alors que le livreur l'a contact√© pour la livraison. Dans ce cas, on fait distinction entre deux cas de figures de livraison :\n\n",
                        sections: [
                            {
                                title: "Annulation d'une commande livr√©e √† Domicile",
                                process: "La livraison √† domicile : Dans ce cas, le livreur, lors de l‚Äôexp√©dition de la commande contacte le client afin de lui fixer la livraison et son heure de passage. Le client peut demander l‚Äôannulation de sa commande. De la part du livreur, il est tenu de traiter la demande client et qualifi√© le cas comme un √©chec de livraison suite √† la demande client.\n\n\n",
                                escalade: ""
                            },
                            {
                                title: "Annulation d'une commande livr√©e via AMANA",
                                process: "La livraison assur√©e via AMANA : Dans ce cas, le client est tenu de ne pas se pr√©senter chez l‚ÄôAgence AMANA dans laquelle sa commande est mise √† sa disposition pour le retrait.\n\nNoter bien que le conseiller est tenu de v√©rifier via le fiche des zones de livraison s‚Äôil s‚Äôagit d‚Äôune livraison √† domicile ou bien via AMANA https://script.google.com/a/macros/intelcia.com/s/AKfycbyIsebC6zgYOVwlJS8XHJsscBFDxhmOR1ONJNej71TDs_JKoRoWaCANxRo2yAcgksW83Q/exec.\n",
                                escalade: ""
                            },
                            {
                                title: "Traitement GRC de la demande client",
                                process: "En ce qui concerne le traitement CRC, le conseiller est tenu √† traiter la demande client conform√©ment √† ce qui suit :\nAccueil : Le conseiller se pr√©sente et pr√©sente la cellule Marjanemall\nS√©curisation : Conform√©ment √† la demande CDO, lorsqu'il s‚Äôagit d‚Äôune demande d‚Äôannulation de la commande, l‚Äôagent est tenu √† s√©curiser la discussion en demandant du client son adresse mail et le num√©ro de la commande objet d‚Äôannulation.\nTraitement de la demande : Le conseiller est tenu d‚Äôinformer le client que nous n‚Äôavons pas la capacit√© de bien annuler sa commande. Il est tenu aussi de demander au client de bien refuser sa livraison. A titre d‚Äôinformation, si le client insiste, le conseiller est tenu de bien remonter le cas au Log. Niv2/Transport local en demandant de bien qualifier la commande √† la base comme √©chec de livraison et ne pas contacter le client.\nIl faut bien √©videmment signaler que le conseiller est tenu par obligation de bien notifier au moins le client via un Mail ou un AS avant de cl√¥turer le ticket.\n\n",
                                escalade: ""
                            }
                        ]
                    }
                },
                "Non exp√©di√©e": {
                    "Annulation Client": {
                        title: "Annulation Client",
                        overview: "Cette fiche a pour objectif d'assister les agents du CRC dans le traitement des demandes clients relatives √† l'annulation de commandes, sous r√©serve que celles-ci n'aient pas encore √©t√© exp√©di√©es.\\n\\nElle pr√©sente l'ensemble des √©tapes √† suivre par l'agent CC, le script √† communiquer au client concern√©, ainsi que le traitement √† effectuer dans le ticket Zendesk.\\n\\nIl faut au pr√©alable faire distinction entre deux cas :",
                        sections: [
                            {
                                title: "Annulation via RS, Mail, MobileSDK ou AE",
                                process: "Une annulation de la part du client via les RS, Mail, MobileSDK ou AE : Il s'agit dans ce cas d'une manifestation client afin de demander l'annulation de sa commande. Ceci est un traitement n√©cessitant une interaction avec le client et par la suite proc√©der √† l'annulation.",
                                overview: "1. Accueil : Le conseiller se pr√©sente et pr√©sente la cellule MarjaneMall\\n\\n2. S√©curisation : Conform√©ment √† la demande CDO, lorsqu'elle s'agit d'une demande d'annulation de la commande, l'agent est tenu √† s√©curiser la discussion en demandant du client son adresse mail et le num√©ro de la commande objet d'annulation.\\n\\n3. Traitement de la demande : Le conseiller est tenu de confirmer la prise en compte de l'annulation, rassurer le client et l'informer du processus de remboursement."
                            },
                            {
                                title: "Annulation via espace client",
                                process: "Une annulation via son espace client : Lors qu'il s'agit d'une annulation client via son espace client, il s'est trait√© comme un ticket API nomm√©. Dans ce cas, il s'agit purement d'un traitement BACK OFFICE. C'est √† dire le traitement n'entraine aucune interaction avec le client.",
                                overview: "1. Remplissage Zendesk : L'agent est tenu √† remplir les informations n√©cessaires sur Zendesk :\\n   - Choisir API comme Canal de r√©ception\\n   - Choisir DEMANDE d'ANNULATION comme Cat√©gorie\\n   - Assigner le NUM√âRO DE LA COMMANDE OBJET D'ANNULATION\\n   - Choisir ANNULATION CLIENT comme qualification\\n\\n2. Suppression commande SCALE : Demander la suppression de la commande sur SCALE s'il s'agit d'une commande FFM"
                            }
                        ]
                    },
                    "Annulation Syst√®me": {
                        process: "1. Identifier la cause de l'annulation syst√®me\\n2. V√©rifier les stocks et disponibilit√© produits\\n3. Contacter le client pour l'informer\\n4. Proposer des alternatives si disponibles\\n5. Proc√©der au remboursement automatique"
                    },
                    "Annulation Vendeur": {
                        process: "1. Contacter le vendeur pour comprendre les raisons\\n2. Informer imm√©diatement le client\\n3. Proposer des produits similaires\\n4. Initier le remboursement si aucune alternative\\n5. Escalader si r√©currence du vendeur"
                    },
                    "Fraude": {
                        process: "1. Bloquer imm√©diatement la commande\\n2. V√©rifier les informations de paiement\\n3. Contacter le service s√©curit√©\\n4. Documenter tous les √©l√©ments suspects\\n5. Appliquer les proc√©dures anti-fraude"
                    }
                }
            },
            "Confirmation de la commande": {
                "Annul√©e": {
                    "Commande rejet√©e": {
                        process: "1. Identifier la raison du rejet\\n2. V√©rifier les informations de paiement\\n3. Contacter le client pour clarification\\n4. Corriger les informations si possible\\n5. Relancer la validation ou confirmer l'annulation"
                    },
                    "Erreur sur la Commande": {
                        process: "1. Analyser le type d'erreur d√©tect√©e\\n2. V√©rifier si correction possible\\n3. Contacter le client pour validation des modifications\\n4. Corriger et relancer la commande\\n5. Confirmer les nouvelles conditions au client"
                    }
                },
                "Confirm√©e": {
                    "Confirm√©e avec Appel": {
                        process: "1. Programmer l'appel de confirmation\\n2. V√©rifier toutes les informations commande\\n3. Confirmer les d√©tails avec le client\\n4. Mettre √† jour le statut dans le syst√®me\\n5. Envoyer la confirmation √©crite"
                    },
                    "Confirm√©e sans Appel": {
                        process: "1. V√©rifier la validation automatique\\n2. Contr√¥ler les informations de livraison\\n3. Valider le paiement\\n4. Confirmer la commande dans le syst√®me\\n5. Envoyer la notification de confirmation"
                    }
                }
            },
            "Coupon": {
                "Coupon Consomm√©": {
                    process: "1. V√©rifier l'historique d'utilisation du coupon\\n2. Confirmer la date et commande d'utilisation\\n3. Expliquer au client les conditions d'usage unique\\n4. Proposer d'autres offres disponibles\\n5. Documenter la demande client"
                },
                "Coupon Expir√©": {
                    process: "1. V√©rifier la date d'expiration du coupon\\n2. Confirmer avec le client la date d'expiration\\n3. Expliquer la politique d'expiration\\n4. V√©rifier s'il y a d'autres promotions actives\\n5. Proposer des alternatives actuelles"
                },
                "Coupon Invalide": {
                    process: "1. V√©rifier la validit√© du code coupon\\n2. Contr√¥ler les conditions d'√©ligibilit√©\\n3. V√©rifier les produits concern√©s par le coupon\\n4. Expliquer les conditions d'utilisation\\n5. Proposer des coupons valides si disponibles"
                }
            },
            "Demande de Retour": {
                "Process de retour": {
                    process: "1. V√©rifier l'√©ligibilit√© du produit au retour\\n2. Contr√¥ler les d√©lais de retour (14 jours)\\n3. Expliquer la proc√©dure de retour au client\\n4. G√©n√©rer l'√©tiquette de retour\\n5. Programmer la collecte du produit"
                },
                "Accessoire Manquant": {
                    process: "1. Identifier l'accessoire manquant\\n2. V√©rifier le contenu standard du produit\\n3. Contacter le fournisseur/vendeur\\n4. Organiser l'envoi de l'accessoire manquant\\n5. Offrir un geste commercial si d√©lai important"
                },
                "Erreur de R√©f√©rence": {
                    process: "1. Comparer la commande avec le produit re√ßu\\n2. Identifier l'origine de l'erreur\\n3. Organiser la r√©cup√©ration du mauvais produit\\n4. Exp√©dier le bon produit imm√©diatement\\n5. Offrir un geste commercial pour le d√©sagr√©ment"
                },
                "Panne au D√©ballage": {
                    process: "1. Documenter la panne constat√©e\\n2. V√©rifier si c'est un d√©faut de fabrication\\n3. Prendre des photos si n√©cessaire\\n4. Contacter le service technique/fournisseur\\n5. Proposer remplacement ou remboursement"
                },
                "Produit Ab√Æm√©": {
                    process: "1. √âvaluer l'√©tat du produit (photos)\\n2. D√©terminer si dommage li√© au transport\\n3. Contacter le transporteur si n√©cessaire\\n4. Proposer √©change ou remboursement\\n5. Organiser la collecte du produit ab√Æm√©"
                },
                "R√©tractation": {
                    "Produit √âligible": {
                        process: "1. Confirmer l'√©ligibilit√© au droit de r√©tractation\\n2. V√©rifier les d√©lais (14 jours)\\n3. Expliquer les conditions de retour\\n4. G√©n√©rer l'√©tiquette de retour gratuite\\n5. Initier le processus de remboursement"
                    },
                    "Produit non √âligible": {
                        process: "1. Expliquer pourquoi le produit n'est pas √©ligible\\n2. R√©f√©rencer les conditions g√©n√©rales\\n3. Proposer des alternatives (garantie, SAV)\\n4. Documenter la demande\\n5. Escalader si contestation du client"
                    }
                }
            },
            "Demande SAV": {
                "Autre": {
                    process: "1. √âcouter et analyser la demande sp√©cifique\\n2. Identifier la nature du probl√®me\\n3. V√©rifier les conditions de garantie\\n4. Orienter vers le service appropri√©\\n5. Assurer le suivi de la demande"
                },
                "Hors Garantie": {
                    process: "1. V√©rifier la date d'achat et fin de garantie\\n2. Expliquer les limitations hors garantie\\n3. Proposer une r√©paration payante si possible\\n4. Informer sur les tarifs de r√©paration\\n5. Documenter la d√©cision du client"
                },
                "Prise en Charge": {
                    process: "1. Valider l'√©ligibilit√© √† la prise en charge\\n2. Organiser la collecte du produit\\n3. Transmettre au service technique\\n4. Informer le client des d√©lais\\n5. Assurer le suivi r√©gulier"
                },
                "Refus de Prise en Charge": {
                    process: "1. Expliquer les raisons du refus\\n2. R√©f√©rencer les conditions de garantie\\n3. Proposer des alternatives (r√©paration payante)\\n4. Documenter la justification\\n5. Escalader si contestation fond√©e"
                },
                "Retard de Prise en Charge": {
                    process: "1. Identifier les causes du retard\\n2. Contacter le service technique\\n3. Donner un nouveau d√©lai r√©aliste\\n4. Offrir un geste commercial\\n5. Assurer un suivi prioritaire"
                }
            },
            "Informations": {
                "Informations Compte Client": {
                    process: "1. V√©rifier l'identit√© du client\\n2. Acc√©der aux informations compte\\n3. R√©pondre aux questions sp√©cifiques\\n4. Proposer les modifications n√©cessaires\\n5. Confirmer les changements effectu√©s"
                },
                "Informations Marketplace": {
                    process: "1. Identifier la question sur le marketplace\\n2. Expliquer le fonctionnement des vendeurs\\n3. Orienter vers les politiques appropri√©es\\n4. Donner les contacts vendeurs si n√©cessaire\\n5. Assurer le suivi si probl√®me complexe"
                },
                "Informations Coupon": {
                    process: "1. V√©rifier les coupons disponibles\\n2. Expliquer les conditions d'utilisation\\n3. Aider √† l'application du coupon\\n4. R√©soudre les probl√®mes techniques\\n5. Proposer des alternatives si n√©cessaire"
                },
                "Informations sur nos Offres": {
                    process: "1. Identifier le type d'offre demand√©e\\n2. Pr√©senter les offres actuelles\\n3. Expliquer les conditions de chaque offre\\n4. Aider √† l'inscription si n√©cessaire\\n5. Orienter vers les supports marketing"
                },
                "Informations sur non Produits": {
                    process: "1. Identifier le produit recherch√©\\n2. V√©rifier la disponibilit√© future\\n3. Proposer des produits similaires\\n4. Expliquer les d√©lais de r√©approvisionnement\\n5. Proposer d'√™tre notifi√© lors de la disponibilit√©"
                },
                "Nos d√©lais de Livraison": {
                    process: "1. Identifier la zone de livraison\\n2. Pr√©senter les d√©lais selon le type de produit\\n3. Expliquer les options de livraison\\n4. Informer sur les d√©lais sp√©ciaux (week-end, f√™tes)\\n5. Donner les coordonn√©es pour le suivi"
                },
                "Nos Modalit√©s de Paiement": {
                    process: "1. Pr√©senter tous les modes de paiement\\n2. Expliquer les conditions de chaque mode\\n3. Aider √† r√©soudre les probl√®mes de paiement\\n4. Expliquer la s√©curit√© des paiements\\n5. Orienter vers l'assistance technique si n√©cessaire"
                }
            },
            "Livraison": {
                "Changement de Coordonn√©es": {
                    process: "1. V√©rifier si la modification est possible\\n2. Contr√¥ler les nouvelles coordonn√©es\\n3. Mettre √† jour dans le syst√®me\\n4. Informer le transporteur si n√©cessaire\\n5. Confirmer les changements au client"
                },
                "Livraison dans la Promesse": {
                    process: "1. Confirmer les d√©lais respect√©s\\n2. V√©rifier la satisfaction client\\n3. S'assurer de l'√©tat du produit\\n4. Demander un feedback sur la livraison\\n5. Noter les points positifs pour l'√©quipe"
                },
                "Livraison hors la Promesse": {
                    process: "1. Identifier les causes du retard\\n2. S'excuser aupr√®s du client\\n3. Proposer un geste commercial\\n4. Donner un nouveau d√©lai r√©aliste\\n5. Assurer un suivi prioritaire"
                },
                "Comportement Livreur": {
                    process: "1. √âcouter attentivement la plainte\\n2. Documenter pr√©cis√©ment les faits\\n3. S'excuser au nom de l'entreprise\\n4. Transmettre au responsable transport\\n5. Assurer le suivi des actions correctives"
                },
                "R√©clamation Livraison": {
                    process: "1. Analyser la nature de la r√©clamation\\n2. V√©rifier les informations de livraison\\n3. Contacter le transporteur si n√©cessaire\\n4. Proposer une solution appropri√©e\\n5. Assurer le suivi jusqu'√† r√©solution"
                },
                "R√©clamation Livraison Amana": {
                    process: "1. Contacter directement Amana\\n2. Transmettre les d√©tails de la r√©clamation\\n3. Faire le lien entre le client et Amana\\n4. Assurer le suivi de la r√©solution\\n5. S'assurer de la satisfaction finale"
                }
            },
            "Paiement / Remboursement": {
                "Facture": {
                    "Demande de Facture": {
                        process: "1. V√©rifier les informations de commande\\n2. G√©n√©rer la facture dans le syst√®me\\n3. V√©rifier les informations fiscales\\n4. Envoyer la facture par email\\n5. Confirmer la r√©ception avec le client"
                    },
                    "Facture √ârron√©e": {
                        process: "1. Identifier les erreurs sur la facture\\n2. V√©rifier les bonnes informations\\n3. Corriger et r√©g√©n√©rer la facture\\n4. Annuler l'ancienne facture si n√©cessaire\\n5. Envoyer la facture corrig√©e"
                    },
                    "Facture Indisponible": {
                        process: "1. V√©rifier les raisons de l'indisponibilit√©\\n2. Contr√¥ler le statut de la commande\\n3. Expliquer les d√©lais de g√©n√©ration\\n4. Programmer l'envoi d√®s disponibilit√©\\n5. Proposer une attestation temporaire"
                    },
                    "Preuve d'Achat": {
                        process: "1. V√©rifier l'historique de commande\\n2. G√©n√©rer l'attestation d'achat\\n3. Inclure tous les d√©tails n√©cessaires\\n4. Envoyer par email s√©curis√©\\n5. Confirmer la r√©ception"
                    }
                },
                "Probl√®me de Paiement": {
                    process: "1. Identifier le type de probl√®me de paiement\\n2. V√©rifier les informations bancaires\\n3. Contacter le service paiement\\n4. Proposer des alternatives de paiement\\n5. Assurer le suivi jusqu'√† r√©solution"
                },
                "Remboursement": {
                    "Code WAFACASH Erronn√©": {
                        process: "1. V√©rifier le code WAFACASH g√©n√©r√©\\n2. Identifier l'erreur dans le syst√®me\\n3. Corriger et g√©n√©rer un nouveau code\\n4. Annuler l'ancien code si n√©cessaire\\n5. Envoyer le code correct au client"
                    },
                    "Code WAFACASH non Re√ßu ou Expir√©": {
                        process: "1. V√©rifier le statut du code dans le syst√®me\\n2. Contr√¥ler la date d'expiration (90 jours)\\n3. R√©g√©n√©rer un nouveau code si expir√©\\n4. Renvoyer par SMS et email\\n5. Confirmer la r√©ception avec le client"
                    },
                    "Demande de Modification du B√©n√©ficiaire": {
                        process: "1. V√©rifier l'identit√© du demandeur\\n2. Contr√¥ler les raisons de la modification\\n3. Valider les nouvelles informations\\n4. G√©n√©rer un nouveau code au bon nom\\n5. Annuler l'ancien code"
                    },
                    "Nom Client WAFACASH Erronn√© ou Incomplet": {
                        process: "1. Identifier l'erreur dans le nom\\n2. V√©rifier les bonnes informations client\\n3. Corriger dans le syst√®me\\n4. R√©g√©n√©rer le code avec le bon nom\\n5. Informer le client des corrections"
                    },
                    "Remboursement CB non Re√ßu": {
                        process: "1. V√©rifier le statut du remboursement\\n2. Contr√¥ler les d√©lais bancaires (3-5 jours)\\n3. Contacter la banque si d√©lai d√©pass√©\\n4. Fournir les justificatifs au client\\n5. Assurer le suivi jusqu'√† cr√©dit effectif"
                    }
                }
            },
            "R√©clamation": {
                "Autre": {
                    process: "1. √âcouter attentivement la r√©clamation\\n2. Analyser et cat√©goriser le probl√®me\\n3. Rechercher une solution appropri√©e\\n4. Proposer des actions correctives\\n5. Assurer le suivi complet"
                },
                "Produit Manquant": {
                    process: "1. V√©rifier le contenu de la commande livr√©e\\n2. Identifier le/les produits manquants\\n3. Contr√¥ler avec le transporteur\\n4. Organiser l'envoi du produit manquant\\n5. Offrir un geste commercial pour le d√©sagr√©ment"
                },
                "Produit non Re√ßu": {
                    process: "1. V√©rifier le statut de livraison\\n2. Contacter le transporteur pour enqu√™te\\n3. Localiser le colis si possible\\n4. Proposer un renvoi ou remboursement\\n5. Assurer un suivi prioritaire"
                },
                "Produit Re√ßu en Double": {
                    process: "1. V√©rifier s'il s'agit d'une erreur syst√®me\\n2. Contr√¥ler les charges sur le compte client\\n3. Organiser la collecte du produit en trop\\n4. Ajuster la facturation si n√©cessaire\\n5. S'excuser pour l'erreur"
                }
            },
            "SPAM / Test / Plaisantin": {
                process: "1. Identifier la nature non-l√©gitime de la demande\\n2. Ne pas engager de conversation prolong√©e\\n3. Documenter le contact dans le syst√®me\\n4. Appliquer les mesures de protection\\n5. Signaler si r√©currence du comportement"
            }
        };

        // Initialisation au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            generateKnowledgeTree();
        });

        // Fonction de recherche
        function searchKnowledge() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const items = document.querySelectorAll('.process-item, .subcategory-header, .category-header');
            
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                const matches = text.includes(searchTerm);
                item.style.display = matches || searchTerm === '' ? 'flex' : 'none';
                
                if (matches && searchTerm !== '') {
                    let parent = item.closest('.subcategories');
                    if (parent) {
                        parent.classList.add('expanded');
                        parent.previousElementSibling.classList.add('expanded');
                    }
                    parent = item.closest('.tree-category');
                    if (parent) {
                        parent.querySelector('.subcategories').classList.add('expanded');
                        parent.querySelector('.category-header').classList.add('expanded');
                    }
                }
            });
        }

        // G√©n√©ration de l'arborescence
        function generateKnowledgeTree() {
            const container = document.getElementById('treeContainer');
            container.innerHTML = '';

            Object.keys(knowledgeBase).forEach(category => {
                const categoryDiv = createCategoryElement(category, knowledgeBase[category]);
                container.appendChild(categoryDiv);
            });
        }

        function createCategoryElement(categoryName, categoryData) {
            const categoryDiv = document.createElement('div');
            categoryDiv.className = 'tree-category';

            const headerDiv = document.createElement('div');
            headerDiv.className = 'category-header';
            headerDiv.innerHTML = `
                <span>${categoryName}</span>
                <span class="category-arrow">‚ñ∫</span>
            `;
            
            headerDiv.addEventListener('click', () => toggleCategory(headerDiv));
            
            const subcategoriesDiv = document.createElement('div');
            subcategoriesDiv.className = 'subcategories';

            Object.keys(categoryData).forEach(key => {
                if (categoryData[key].process) {
                    const processItem = createProcessElement(key, categoryData[key].process);
                    subcategoriesDiv.appendChild(processItem);
                } else {
                    const subcategoryElement = createSubcategoryElement(key, categoryData[key]);
                    subcategoriesDiv.appendChild(subcategoryElement);
                }
            });

            categoryDiv.appendChild(headerDiv);
            categoryDiv.appendChild(subcategoriesDiv);
            
            return categoryDiv;
        }

        function createSubcategoryElement(subcategoryName, subcategoryData) {
            const subcategoryDiv = document.createElement('div');
            subcategoryDiv.className = 'subcategory';

            const headerDiv = document.createElement('div');
            headerDiv.className = 'subcategory-header';
            headerDiv.innerHTML = `
                <span>${subcategoryName}</span>
                <span class="category-arrow">‚ñ∫</span>
            `;
            
            headerDiv.addEventListener('click', () => toggleSubcategory(headerDiv));
            
            const processesDiv = document.createElement('div');
            processesDiv.className = 'processes';

            Object.keys(subcategoryData).forEach(processName => {
                const processData = subcategoryData[processName];
                const processItem = createProcessElement(processName, processData);
                processesDiv.appendChild(processItem);
            });

            subcategoryDiv.appendChild(headerDiv);
            subcategoryDiv.appendChild(processesDiv);
            
            return subcategoryDiv;
        }

        function createProcessElement(processName, processData) {
            const processDiv = document.createElement('div');
            processDiv.className = 'process-item';
            processDiv.textContent = processName;
            processDiv.addEventListener('click', () => showProcessDetails(processName, processData));
            return processDiv;
        }

        function toggleCategory(header) {
            const subcategories = header.nextElementSibling;
            const arrow = header.querySelector('.category-arrow');
            
            header.classList.toggle('expanded');
            subcategories.classList.toggle('expanded');
            arrow.style.transform = header.classList.contains('expanded') ? 'rotate(90deg)' : 'rotate(0deg)';
        }

        function toggleSubcategory(header) {
            const processes = header.nextElementSibling;
            const arrow = header.querySelector('.category-arrow');
            
            header.classList.toggle('expanded');
            processes.classList.toggle('expanded');
            arrow.style.transform = header.classList.contains('expanded') ? 'rotate(90deg)' : 'rotate(0deg)';
        }

        function showProcessDetails(processName, processData) {
            document.querySelectorAll('.process-item').forEach(item => {
                item.classList.remove('active');
            });
            
            event.target.classList.add('active');
            
            const detailsContainer = document.getElementById('processDetails');
            
            // G√©rer les anciens formats (simple process string) et nouveaux formats (avec sections)
            if (typeof processData === 'string') {
                // Format simple ancien
                detailsContainer.innerHTML = `
                    <div class="process-title">${processName}</div>
                    <div class="process-step">
                        <div class="step-title">Processus √† suivre :</div>
                        <div class="step-content">${processData.replace(/\\n/g, '<br>')}</div>
                    </div>
                `;
            } else if (processData.sections) {
                // Nouveau format avec sections d√©taill√©es
                let sectionsHTML = '';
                
                processData.sections.forEach(section => {
                    sectionsHTML += `
                        <div class="process-section">
                            <div class="section-title">${section.title}</div>
                            <div class="section-process">
                                <div class="step-title">Description :</div>
                                <div class="step-content">${section.process.replace(/\\n/g, '<br>')}</div>
                            </div>
                            <div class="section-process">
                                <div class="step-title">Process √† suivre :</div>
                                <div class="section-overview">${section.overview.replace(/\\n/g, '<br>')}</div> 
                            </div>
                        </div>
                    `;
                });
                
                detailsContainer.innerHTML = `
                    <div class="process-title">${processData.title || processName}</div>
                    <div class="process-overview">${processData.overview.replace(/\\n/g, '<br>')}</div>
                    ${sectionsHTML}
                `;
            } else {
                // Format avec process simple mais dans un objet
                const content = processData.process || processData;
                detailsContainer.innerHTML = `
                    <div class="process-title">${processName}</div>
                    <div class="process-step">
                        <div class="step-title">Processus √† suivre :</div>
                        <div class="step-content">${content.replace(/\\n/g, '<br>')}</div>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>